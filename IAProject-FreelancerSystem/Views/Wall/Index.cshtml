
@{
    ViewBag.Title = "Index";
    var User = Session["User"] as IAProject_FreelancerSystem.Models.User;

    var savedJobs = ViewData["savedJobs"] as List<IAProject_FreelancerSystem.Models.SavedJob>;

    var rates = ViewData["ratedJobs"] as List<IAProject_FreelancerSystem.Models.Rate>;

    var proposels= ViewData["proposelJob"] as List<IAProject_FreelancerSystem.Models.Proposal>;

    var jobs = ViewData["Jobs"] as List<IAProject_FreelancerSystem.Models.Job>;

}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="style.css">

    <link href="@Url.Content("~/Content/Site.css")" rel="stylesheet" type="text/css" />

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>"PostsPage"</title>

</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light justify-content-between">
        <div class="container">
            <a class="navbar-brand" href="/Dashboard/profile">Freelance Project</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav mr-auto">
                    @if (User != null)
                    {
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="/Wall/SavedJobs">Your Saved Jobs</a>
                        </li>
                    }
                </ul>
                @if (User == null)
                {
                    <div class="my-2 my-lg-0">
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal_Register">
                            Register
                        </button>
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal_Login">
                            Login
                        </button>
                    </div>
                }
                else
                {
                    <!-- Start of Logout Form -->
                    <form action="/Wall/LogoutForm" method="post">
                        <input type="submit" class="btn btn-primary" value="Logout" />
                    </form>
                    <!-- End of Logout Form -->
                }
            </div>
        </div>
    </nav>



    <div class="container body-content">

        <div class="row mt-4">
            <form action="/Wall/Search" method="post" class="col-md-6">
                <input style="display: none" type="text" name="type" value="title" />
                <div class="row g-3">
                    <div class="col-sm-7">
                        <input type="text" name="dataToSearch" class="form-control" placeholder="Search with Title">
                    </div>
                    <div class="col-sm">
                        <button type="submit" class="btn btn-primary mb-2">Search</button>
                    </div>
                </div>
            </form>

            <form action="/Wall/Search" method="post" class="col-md-6">
                <input style="display: none" type="text" name="type" value="client" />
                <div class="row g-3">
                    <div class="col-sm-7">
                        <input type="text" name="dataToSearch" class="form-control" placeholder="Search with Client">
                    </div>
                    <div class="col-sm">
                        <button type="submit" class="btn btn-primary mb-2">Search</button>
                    </div>
                </div>
            </form>
        </div>

        <form action="/Wall/Search" method="post">
            <input style="display: none" type="text" name="type" value="createDate" />
            <div class="row g-3">
                <div class="col-sm-5">
                    <input type="datetime-local" name="from_dataToSearch" class="form-control">
                </div>
                <div class="col-sm-5">
                    <input type="datetime-local" name="to_dataToSearch" class="form-control" placeholder="State" aria-label="State">
                </div>
                <div class="col-sm">
                    <button type="submit" class="btn btn-primary mb-2">Search</button>
                </div>
            </div>
        </form>

        <!-- Start of Jobs Card -->
        @for (int i = 0; i < jobs.Count(); i++)
        {
            <div>
                <h3>jobTitle: @jobs[i].jobTitle</h3>
                <h3>jobBudget: @jobs[i].jobBudget</h3>
                <h3>jobType: @jobs[i].jobType</h3>
                <h3>jobDescription: @jobs[i].jobDescription</h3>
                <h3>jobAVGRate: @jobs[i].jobAVGRate</h3>
                <h3>propCount: @jobs[i].propCount</h3>
                <h3>creationDate: @jobs[i].creationDate</h3>

                <!-- If Login as Freelancer -->
                @if (User != null)
                {

                    <!-- Start of Save -->
                    <form action="/Wall/SaveJob" method="post">
                        <input style="display: none" type="text" name="userID" value="@User.userID" />
                        <input style="display: none" type="text" name="jobID" value="@jobs[i].jobID" />
                        <input style="display: none" type="text" name="jobTitle" value="@jobs[i].jobTitle" />
                        @if (savedJobs.FindAll(s => s.jobID == jobs[i].jobID).Count() == 0)
                        {
                            <input type="submit" value="Save" />
                        }
                        else
                        {
                            <h5>Saved</h5>
                        }
                    </form>
                    <!-- End of Save -->


                    <!-- Start of Propsel -->
                    <script type="text/javascript">
                        function ToggleDiv(id) {
                            console.log(id)
                            if (document.getElementById(id).style.display == 'block')
                                document.getElementById(id).style.display = 'none';
                            else
                                document.getElementById(id).style.display = 'block';
                        }
                    </script>
                    if (proposels.FindAll(s => s.jobID == jobs[i].jobID).Count() == 0)
                    {
                        <button ID="btn" runat="server" Text="Show First Div"
                                onclick="ToggleDiv(@jobs[i].jobID);">
                            Give a Proposel
                        </button>
                    }
                    else
                    {
                        <h5>Proposel Already Send</h5>
                    }
                    <br />
                    <div id="@jobs[i].jobID" style="display: none;">
                        <form action="/Wall/GivePropsel" method="post">
                            <input style="display: none" type="text" name="userID" value="@User.userID" />
                            <input style="display: none" type="text" name="jobID" value="@jobs[i].jobID" />
                            Price: <input type="number" name="propPrice" />
                            Describtion: <textarea type="text" name="propDescription"></textarea>
                            <input type="submit" value="Submit" />
                        </form>
                    </div>
                    <!-- End of Propsel -->



                    <!-- Start of Rate -->
                    if (rates.FindAll(r => r.jobID == jobs[i].jobID).Count() != 0)
                    {
                        <h5>@rates.FindAll(r => r.jobID == jobs[i].jobID)[0].rate / 5</h5>
                    }
                    else
                    {
                        <form action="/Wall/GiveRate" method="post">
                            <input style="display: none" type="text" name="userID" value="@User.userID" />
                            <input style="display: none" type="text" name="jobID" value="@jobs[i].jobID" />
                            <input type="number" max="5" name="rateToAdd" />
                            <input type="submit" value="Rate" />
                        </form>
                    }
                    <!-- End of Rate -->
                }
                <!-- End of Jobs Card -->

                <hr />

            </div>
        }
    </div>


    <!-- Modal -->
    <div class="modal fade" id="exampleModal_Register" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Register</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Start of Register Form -->
                        @using (Html.BeginForm("RegisterForm", "Wall", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            <div class=" mt-4">
                                <label for="validationCustom01" class="form-label">First Name:</label>
                                <input type="text" class="form-control" id="validationCustom01" name="fName" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>
                            <div class=" mt-2">
                                <label for="validationCustom02" class="form-label">Last Name:</label>
                                <input type="text" class="form-control" id="validationCustom02" name="lName" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>
                            <div class=" mt-2">
                                <label for="validationCustom02" class="form-label">User Name:</label>
                                <input type="text" class="form-control" id="validationCustom02" name="userName" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>
                            <div class=" mt-2">
                                <label for="validationCustom02" class="form-label">Email:</label>
                                <input type="email" class="form-control" id="exampleInputEmail1" name="email">
                            </div>
                            <div class=" mt-2">
                                <label for="validationCustom02" class="form-label">Phone Number:</label>
                                <input type="text" class="form-control" id="validationCustom02" name="phoneNum" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>

                            <div class=" mt-2">
                                <label for="validationCustom02" class="form-label">Password:</label>
                                <input type="password" class="form-control" id="validationCustom02" name="userPassword" required>
                                <div class="valid-feedback">
                                    Looks good!
                                </div>
                            </div>
                            <div class="mt-2">
                                <label for="validationCustom02" class="form-label">Photo:</label>
                                <div class="custom-file">
                                    <input type="file" class="custom-file-input" id="inputGroupFile01" name="postedFile">
                                    <label class="custom-file-label" for="inputGroupFile01">Choose file</label>
                                </div>
                            </div>
                            <div class="mt-2">
                                <label for="validationCustom02" class="form-label">Role:</label>
                                <select class="form-control" aria-label="Default select example" name="role">
                                    <option value="client">Client</option>
                                    <option value="freelancer">Freelancer</option>
                                </select>

                            </div>

                            <button type="submit" class="btn btn-primary mt-2 col-12">Register</button>

                        }
                    <!-- End of Register Form -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="exampleModal_Login" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Login</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Start of Login Form -->
                    <form action="/Wall/LoginForm" method="post">
                        <div class=" mt-2">
                            <label for="validationCustom02" class="form-label">User Name:</label>
                            <input type="text" class="form-control" id="validationCustom02" name="userName" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                        </div>
                        <div class=" mt-2">
                            <label for="validationCustom02" class="form-label">Password:</label>
                            <input type="password" class="form-control" id="validationCustom02" name="password" required>
                            <div class="valid-feedback">
                                Looks good!
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary mt-2 col-12">Login</button>
                    </form>
                    <!-- End of Login Form -->
                </div>
            </div>
        </div>
    </div>

    <div class="row justify-content-center mt-5">
        <div class="col-md-4">
            <hr />
            <footer>
                <p>&copy; @DateTime.Now.Year - My ASP.NET Application</p>
            </footer>
        </div>
    </div>


    

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</body>
</html>